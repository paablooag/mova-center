<section id="contacto" class="py-12 sm:py-16 md:py-20 px-4 sm:px-6 bg-white">
	<div class="max-w-4xl mx-auto">
		<h2 id="contact-title" class="text-3xl sm:text-4xl md:text-5xl font-bold mb-8 sm:mb-12 text-center">
			Contacto y Ubicación
		</h2>
		<div class="grid md:grid-cols-2 gap-8 sm:gap-12">
			<div id="contact-info">
				<h3 id="info-title" class="text-xl sm:text-2xl font-bold mb-4 sm:mb-6">Información</h3>
				<div class="space-y-4 text-base sm:text-lg">
					<div id="address-card">
						<p class="font-semibold mb-2">Dirección</p>
						<p class="text-gray-700">
							Avenida de Don Bosco, 19<br />
							Granada, Spain 18007
						</p>
					</div>
					<div id="social-card">
						<p class="font-semibold mb-2">Redes Sociales</p>
						<a 
							id="instagram-link"
							href="https://www.instagram.com/mova.center/" 
							target="_blank"
							rel="noopener noreferrer"
							class="text-gray-700 hover:text-black transition-colors"
						>
							Instagram: @mova.center
						</a>
					</div>
				</div>
			</div>
			<div id="reservation-section">
				<h3 id="reservation-title" class="text-xl sm:text-2xl font-bold mb-4 sm:mb-6">Reserva tu sesión</h3>
				<p id="reservation-text" class="text-base sm:text-lg text-gray-700 mb-4 sm:mb-6 leading-relaxed">
					Completa el formulario para reservar tu primera sesión. Te contactaremos a la mayor brevedad posible.
				</p>
				<a 
					id="form-button"
					href="https://forms.gle/iy1muycEfLf767Mk7" 
					target="_blank"
					rel="noopener noreferrer"
					class="inline-block bg-black text-white px-6 sm:px-8 py-3 sm:py-4 text-base sm:text-lg font-semibold hover:bg-gray-900 transition-all duration-300 hover:scale-105 w-full sm:w-auto text-center"
				>
					Ir al formulario
				</a>
			</div>
		</div>
		<div id="map-container" class="mt-8 sm:mt-12 h-64 sm:h-80 md:h-96 w-full overflow-hidden rounded-lg shadow-lg">
			<iframe
				src="https://www.google.com/maps?q=Avenida+de+Don+Bosco+19+Granada+Spain+18007&output=embed"
				width="100%"
				height="100%"
				style="border:0;"
				allowfullscreen=""
				loading="lazy"
				referrerpolicy="no-referrer-when-downgrade"
				title="Ubicación MOVA CENTER - Avenida de Don Bosco, 19, Granada"
			></iframe>
		</div>
	</div>
</section>

<script>
	import { gsap } from 'gsap';

	// Esperar a que el DOM esté listo y los elementos existan
	function initAnimations() {
		const contactTitle = document.querySelector('#contact-title');
		if (!contactTitle) {
			requestAnimationFrame(initAnimations);
			return;
		}

		const tl = gsap.timeline({ defaults: { ease: 'power3.out' } });

		// Animación del título con efecto de escala y rotación sutil
		gsap.set('#contact-title', { opacity: 0, y: -30, scale: 0.9 });
		tl.to('#contact-title', {
			opacity: 1,
			y: 0,
			scale: 1,
			duration: 0.8,
			rotation: 0.5,
			transformOrigin: 'center center'
		});

		// Animación de la sección de información con efecto de entrada desde la izquierda
		gsap.set('#contact-info', { opacity: 0, x: -100, rotationY: -15 });
		tl.to('#contact-info', {
			opacity: 1,
			x: 0,
			rotationY: 0,
			duration: 0.8,
			ease: 'back.out(1.7)'
		}, '-=0.6');

		// Animación del título de información
		gsap.set('#info-title', { opacity: 0, x: -20 });
		tl.to('#info-title', {
			opacity: 1,
			x: 0,
			duration: 0.5
		}, '-=0.4');

		// Animación de las tarjetas de información con efecto escalonado
		const cards = ['#address-card', '#social-card'];
		cards.forEach((card, index) => {
			gsap.set(card, { opacity: 0, y: 20, scale: 0.95 });
			tl.to(card, {
				opacity: 1,
				y: 0,
				scale: 1,
				duration: 0.6,
				ease: 'elastic.out(1, 0.5)'
			}, `-=${0.5 - index * 0.2}`);
		});

		// Animación del enlace de Instagram con efecto hover mejorado
		const instagramLink = document.querySelector('#instagram-link');
		if (instagramLink) {
			gsap.fromTo('#instagram-link', 
				{ scale: 1 },
				{
					scale: 1.05,
					duration: 0.3,
					yoyo: true,
					repeat: -1,
					ease: 'sine.inOut'
				}
			);

			instagramLink.addEventListener('mouseenter', () => {
				gsap.to('#instagram-link', {
					scale: 1.1,
					rotation: 2,
					duration: 0.3,
					ease: 'back.out(2)'
				});
			});

			instagramLink.addEventListener('mouseleave', () => {
				gsap.to('#instagram-link', {
					scale: 1,
					rotation: 0,
					duration: 0.3
				});
			});
		}

		// Animación de la sección de reserva con efecto de entrada desde la derecha
		gsap.set('#reservation-section', { opacity: 0, x: 100, rotationY: 15 });
		tl.to('#reservation-section', {
			opacity: 1,
			x: 0,
			rotationY: 0,
			duration: 0.8,
			ease: 'back.out(1.7)'
		}, '-=0.8');

		// Animación del título de reserva
		gsap.set('#reservation-title', { opacity: 0, x: 20 });
		tl.to('#reservation-title', {
			opacity: 1,
			x: 0,
			duration: 0.5
		}, '-=0.6');

		// Animación del texto de reserva
		gsap.set('#reservation-text', { opacity: 0, y: 15 });
		tl.to('#reservation-text', {
			opacity: 1,
			y: 0,
			duration: 0.6
		}, '-=0.4');

		// Animación del botón con efecto de pulso y rotación
		gsap.set('#form-button', { opacity: 0, scale: 0.8, rotation: -5 });
		tl.to('#form-button', {
			opacity: 1,
			scale: 1,
			rotation: 0,
			duration: 0.7,
			ease: 'elastic.out(1, 0.6)'
		}, '-=0.5');

		// Efecto hover mejorado para el botón
		const formButton = document.querySelector('#form-button');
		if (formButton) {
			formButton.addEventListener('mouseenter', () => {
				gsap.to('#form-button', {
					scale: 1.1,
					rotation: 3,
					y: -5,
					duration: 0.3,
					ease: 'back.out(2)'
				});
			});

			formButton.addEventListener('mouseleave', () => {
				gsap.to('#form-button', {
					scale: 1,
					rotation: 0,
					y: 0,
					duration: 0.3
				});
			});
		}

		// Animación del mapa con efecto de zoom y entrada
		gsap.set('#map-container', { opacity: 0, scale: 0.9, y: 50 });
		tl.to('#map-container', {
			opacity: 1,
			scale: 1,
			y: 0,
			duration: 1,
			ease: 'power3.out'
		}, '-=0.6');

		// Efecto de parallax suave en el mapa al hacer scroll
		if (typeof window !== 'undefined') {
			const mapContainer = document.querySelector('#map-container');
			if (mapContainer) {
				let ticking = false;
				const scrollHandler = () => {
					if (!ticking) {
						window.requestAnimationFrame(() => {
							const rect = mapContainer.getBoundingClientRect();
							const windowHeight = window.innerHeight;
							const elementHeight = rect.height;
							const elementTop = rect.top;
							const progress = Math.max(0, Math.min(1, (windowHeight - elementTop) / (windowHeight + elementHeight)));
							
							gsap.to('#map-container', {
								y: -20 * progress,
								duration: 0.3,
								ease: 'power1.out'
							});
							
							ticking = false;
						});
						ticking = true;
					}
				};
				window.addEventListener('scroll', scrollHandler, { passive: true });
				scrollHandler();
			}
		}

		// Animación de flotación suave para el título
		gsap.to('#contact-title', {
			y: -10,
			duration: 2,
			ease: 'sine.inOut',
			yoyo: true,
			repeat: -1
		});
	}

	// Inicializar cuando el DOM esté listo
	if (typeof window !== 'undefined') {
		if (document.readyState === 'loading') {
			document.addEventListener('DOMContentLoaded', initAnimations);
		} else {
			initAnimations();
		}
	}
</script>

<style>
	#contact-title {
		transform-origin: center center;
	}

	#form-button {
		transform-origin: center center;
	}

	#map-container {
		transform-origin: center center;
	}
</style>

