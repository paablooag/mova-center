<section id="reviews" class="py-12 sm:py-16 md:py-20 px-4 sm:px-6 bg-gray-50">
	<div class="max-w-6xl mx-auto">
		<h2 id="reviews-title" class="text-3xl sm:text-4xl md:text-5xl font-bold mb-8 sm:mb-12 text-center">
			ReseÃ±as de Google
		</h2>
		<div class="reviews-slider-container relative overflow-hidden">
			<div class="reviews-track flex gap-4 sm:gap-6">
			<div class="review-card bg-white p-6 sm:p-8 border border-gray-200 min-w-[280px] sm:min-w-[300px] flex-shrink-0 min-h-[280px] sm:min-h-[320px] flex flex-col">
				<div class="flex items-center mb-4">
					<div class="flex text-yellow-400 mr-2 text-lg">
						<span>â˜…â˜…â˜…â˜…â˜…</span>
					</div>
					<span class="text-sm text-gray-600">Hace una semana</span>
				</div>
				<p class="text-gray-800 mb-4 leading-relaxed flex-grow">
					Menuda pasada de instalaciones y de profesionales. He estado hoy con mi mujer y nos hemos quedado flipando, lo bonito que tienen todo y bien cuidado, se nota...
				</p>
				<p class="font-semibold text-gray-900">Rafael Varon Ruiz</p>
			</div>
			<div class="review-card bg-white p-6 border border-gray-200 min-w-[300px] md:min-w-[350px] flex-shrink-0">
				<div class="flex items-center mb-4">
					<div class="flex text-yellow-400 mr-2 text-lg">
						<span>â˜…â˜…â˜…â˜…â˜…</span>
					</div>
					<span class="text-sm text-gray-600">Hace una semana</span>
				</div>
				<p class="text-gray-800 mb-4 leading-relaxed flex-grow">
					Mi propia experiencia con ellos en entrenamiento funcional y dirigido hacia una lesiÃ³n especÃ­fica me confirma la profesionalidad con la que trabajan Martin y Alex.
				</p>
				<p class="font-semibold text-gray-900">Angela Morales Navajas</p>
			</div>
			<div class="review-card bg-white p-6 border border-gray-200 min-w-[300px] md:min-w-[350px] flex-shrink-0">
				<div class="flex items-center mb-4">
					<div class="flex text-yellow-400 mr-2 text-lg">
						<span>â˜…â˜…â˜…â˜…â˜…</span>
					</div>
					<span class="text-sm text-gray-600">Hace 2 semanas</span>
				</div>
				<p class="text-gray-800 mb-4 leading-relaxed flex-grow">
					Un equipo encantador, Martin y Alex, son buenÃ­simos, Alex me tratÃ³ de una dolencia en el hombro y me fue genial, con Martin el entrenamiento, fabuloso...
				</p>
				<p class="font-semibold text-gray-900">Lidia Giner LeÃ³n</p>
			</div>
			<div class="review-card bg-white p-6 border border-gray-200 min-w-[300px] md:min-w-[350px] flex-shrink-0">
				<div class="flex items-center mb-4">
					<div class="flex text-yellow-400 mr-2 text-lg">
						<span>â˜…â˜…â˜…â˜…â˜…</span>
					</div>
					<span class="text-sm text-gray-600">Hace una semana</span>
				</div>
				<p class="text-gray-800 mb-4 leading-relaxed flex-grow">
					Son muy profesionales. Los conozco desde hace tiempo y mi experiencia con el entrenamiento funcional fuÃ© muy satisfactoria. Martin y Alex os van a encantar y el local que han abierto estÃ¡ genial con buenas instalaciones. Os lo recomiendo.
				</p>
				<p class="font-semibold text-gray-900">Nuria Navajas Barrilao</p>
			</div>
			<div class="review-card bg-white p-6 border border-gray-200 min-w-[300px] md:min-w-[350px] flex-shrink-0">
				<div class="flex items-center mb-4">
					<div class="flex text-yellow-400 mr-2 text-lg">
						<span>â˜…â˜…â˜…â˜…â˜…</span>
					</div>
					<span class="text-sm text-gray-600">Hace una semana</span>
				</div>
				<p class="text-gray-800 mb-4 leading-relaxed flex-grow">
					Acabo de entrenar en Mova y me ha encantado. Soy ciclista y sufro bastante de rodilla, me han adaptado el entrenamiento a mis necesidades y estaban muy atentos. Me he apuntado y lo recomiendo mucho!
				</p>
				<p class="font-semibold text-gray-900">Juan Carlos LupiaÃ±ez MuÃ±oz</p>
			</div>
			<div class="review-card bg-white p-6 border border-gray-200 min-w-[300px] md:min-w-[350px] flex-shrink-0">
				<div class="flex items-center mb-4">
					<div class="flex text-yellow-400 mr-2 text-lg">
						<span>â˜…â˜…â˜…â˜…â˜…</span>
					</div>
					<span class="text-sm text-gray-600">Hace 6 dÃ­as</span>
				</div>
				<p class="text-gray-800 mb-4 leading-relaxed flex-grow">
					Llevo desde marzo con una lesiÃ³n de menisco y estoy feliz de ver quÃ© al fin voy a tratar la lesiÃ³n como se merece. El lugar estÃ¡ genial pero lo mejor es la profesionalidad.
				</p>
				<p class="font-semibold text-gray-900">Jesus Entrena</p>
			</div>
			<div class="review-card bg-white p-6 border border-gray-200 min-w-[300px] md:min-w-[350px] flex-shrink-0">
				<div class="flex items-center mb-4">
					<div class="flex text-yellow-400 mr-2 text-lg">
						<span>â˜…â˜…â˜…â˜…â˜…</span>
					</div>
					<span class="text-sm text-gray-600">Hace una semana</span>
				</div>
				<p class="text-gray-800 mb-4 leading-relaxed flex-grow">
					Me siento muy bien entrenando en Mova. Los dos entrenadores, Martin y Alex, son de un trato inmejorable y una profesionalidad admirable. Es el mejor centro de entrenamiento!!! Gracias Martin y Alex!!
				</p>
				<p class="font-semibold text-gray-900">Maria Dolores Rueda Perez</p>
			</div>
			<div class="review-card bg-white p-6 border border-gray-200 min-w-[300px] md:min-w-[350px] flex-shrink-0">
				<div class="flex items-center mb-4">
					<div class="flex text-yellow-400 mr-2 text-lg">
						<span>â˜…â˜…â˜…â˜…â˜…</span>
					</div>
					<span class="text-sm text-gray-600">Hace una semana</span>
				</div>
				<p class="text-gray-800 mb-4 leading-relaxed flex-grow">
					Hoy he estado en Mova, querÃ­a probar la clase gratuita que estÃ¡n ofreciendo, me ha encantado, vaya dos profesionales, entienden muchÃ­simo y me guÃ­an muy bien! Ya me he apuntado! A seguir poniÃ©ndome en forma!
				</p>
				<p class="font-semibold text-gray-900">Carlos LupiaÃ±ez Garcia</p>
			</div>
			<div class="review-card bg-white p-6 border border-gray-200 min-w-[300px] md:min-w-[350px] flex-shrink-0">
				<div class="flex items-center mb-4">
					<div class="flex text-yellow-400 mr-2 text-lg">
						<span>â˜…â˜…â˜…â˜…â˜…</span>
					</div>
					<span class="text-sm text-gray-600">Hace 2 semanas</span>
				</div>
				<p class="text-gray-800 mb-4 leading-relaxed flex-grow">
					Estoy encantado de haber coincidido con este tipo de profesional, me trataron despuÃ©s de mi operaciÃ³n de prÃ³tesis de rodilla y he vuelto a ganar fuerza y movilidad incluso mÃ¡s que antes..ahora voy a ir a entrenar a grupos para mantenerme ğŸ’ªğŸ¼
				</p>
				<p class="font-semibold text-gray-900">Pedro Martinez Lopez</p>
			</div>
			<!-- Duplicar las tarjetas para efecto infinito -->
			<div class="reviews-track-duplicate flex gap-6">
			<div class="review-card bg-white p-8 border border-gray-200 min-w-[280px] md:min-w-[300px] flex-shrink-0 min-h-[320px] flex flex-col">
				<div class="flex items-center mb-4">
					<div class="flex text-yellow-400 mr-2 text-lg">
						<span>â˜…â˜…â˜…â˜…â˜…</span>
					</div>
					<span class="text-sm text-gray-600">Hace una semana</span>
				</div>
				<p class="text-gray-800 mb-4 leading-relaxed flex-grow">
					Menuda pasada de instalaciones y de profesionales. He estado hoy con mi mujer y nos hemos quedado flipando, lo bonito que tienen todo y bien cuidado, se nota...
				</p>
				<p class="font-semibold text-gray-900">Rafael Varon Ruiz</p>
			</div>
			<div class="review-card bg-white p-6 border border-gray-200 min-w-[300px] md:min-w-[350px] flex-shrink-0">
				<div class="flex items-center mb-4">
					<div class="flex text-yellow-400 mr-2 text-lg">
						<span>â˜…â˜…â˜…â˜…â˜…</span>
					</div>
					<span class="text-sm text-gray-600">Hace una semana</span>
				</div>
				<p class="text-gray-800 mb-4 leading-relaxed flex-grow">
					Mi propia experiencia con ellos en entrenamiento funcional y dirigido hacia una lesiÃ³n especÃ­fica me confirma la profesionalidad con la que trabajan Martin y Alex.
				</p>
				<p class="font-semibold text-gray-900">Angela Morales Navajas</p>
			</div>
			<div class="review-card bg-white p-6 border border-gray-200 min-w-[300px] md:min-w-[350px] flex-shrink-0">
				<div class="flex items-center mb-4">
					<div class="flex text-yellow-400 mr-2 text-lg">
						<span>â˜…â˜…â˜…â˜…â˜…</span>
					</div>
					<span class="text-sm text-gray-600">Hace 2 semanas</span>
				</div>
				<p class="text-gray-800 mb-4 leading-relaxed flex-grow">
					Un equipo encantador, Martin y Alex, son buenÃ­simos, Alex me tratÃ³ de una dolencia en el hombro y me fue genial, con Martin el entrenamiento, fabuloso...
				</p>
				<p class="font-semibold text-gray-900">Lidia Giner LeÃ³n</p>
			</div>
			<div class="review-card bg-white p-6 border border-gray-200 min-w-[300px] md:min-w-[350px] flex-shrink-0">
				<div class="flex items-center mb-4">
					<div class="flex text-yellow-400 mr-2 text-lg">
						<span>â˜…â˜…â˜…â˜…â˜…</span>
					</div>
					<span class="text-sm text-gray-600">Hace una semana</span>
				</div>
				<p class="text-gray-800 mb-4 leading-relaxed flex-grow">
					Son muy profesionales. Los conozco desde hace tiempo y mi experiencia con el entrenamiento funcional fuÃ© muy satisfactoria. Martin y Alex os van a encantar y el local que han abierto estÃ¡ genial con buenas instalaciones. Os lo recomiendo.
				</p>
				<p class="font-semibold text-gray-900">Nuria Navajas Barrilao</p>
			</div>
			<div class="review-card bg-white p-6 border border-gray-200 min-w-[300px] md:min-w-[350px] flex-shrink-0">
				<div class="flex items-center mb-4">
					<div class="flex text-yellow-400 mr-2 text-lg">
						<span>â˜…â˜…â˜…â˜…â˜…</span>
					</div>
					<span class="text-sm text-gray-600">Hace una semana</span>
				</div>
				<p class="text-gray-800 mb-4 leading-relaxed flex-grow">
					Acabo de entrenar en Mova y me ha encantado. Soy ciclista y sufro bastante de rodilla, me han adaptado el entrenamiento a mis necesidades y estaban muy atentos. Me he apuntado y lo recomiendo mucho!
				</p>
				<p class="font-semibold text-gray-900">Juan Carlos LupiaÃ±ez MuÃ±oz</p>
			</div>
			<div class="review-card bg-white p-6 border border-gray-200 min-w-[300px] md:min-w-[350px] flex-shrink-0">
				<div class="flex items-center mb-4">
					<div class="flex text-yellow-400 mr-2 text-lg">
						<span>â˜…â˜…â˜…â˜…â˜…</span>
					</div>
					<span class="text-sm text-gray-600">Hace 6 dÃ­as</span>
				</div>
				<p class="text-gray-800 mb-4 leading-relaxed flex-grow">
					Llevo desde marzo con una lesiÃ³n de menisco y estoy feliz de ver quÃ© al fin voy a tratar la lesiÃ³n como se merece. El lugar estÃ¡ genial pero lo mejor es la profesionalidad.
				</p>
				<p class="font-semibold text-gray-900">Jesus Entrena</p>
			</div>
			<div class="review-card bg-white p-6 border border-gray-200 min-w-[300px] md:min-w-[350px] flex-shrink-0">
				<div class="flex items-center mb-4">
					<div class="flex text-yellow-400 mr-2 text-lg">
						<span>â˜…â˜…â˜…â˜…â˜…</span>
					</div>
					<span class="text-sm text-gray-600">Hace una semana</span>
				</div>
				<p class="text-gray-800 mb-4 leading-relaxed flex-grow">
					Me siento muy bien entrenando en Mova. Los dos entrenadores, Martin y Alex, son de un trato inmejorable y una profesionalidad admirable. Es el mejor centro de entrenamiento!!! Gracias Martin y Alex!!
				</p>
				<p class="font-semibold text-gray-900">Maria Dolores Rueda Perez</p>
			</div>
			<div class="review-card bg-white p-6 border border-gray-200 min-w-[300px] md:min-w-[350px] flex-shrink-0">
				<div class="flex items-center mb-4">
					<div class="flex text-yellow-400 mr-2 text-lg">
						<span>â˜…â˜…â˜…â˜…â˜…</span>
					</div>
					<span class="text-sm text-gray-600">Hace una semana</span>
				</div>
				<p class="text-gray-800 mb-4 leading-relaxed flex-grow">
					Hoy he estado en Mova, querÃ­a probar la clase gratuita que estÃ¡n ofreciendo, me ha encantado, vaya dos profesionales, entienden muchÃ­simo y me guÃ­an muy bien! Ya me he apuntado! A seguir poniÃ©ndome en forma!
				</p>
				<p class="font-semibold text-gray-900">Carlos LupiaÃ±ez Garcia</p>
			</div>
			<div class="review-card bg-white p-6 border border-gray-200 min-w-[300px] md:min-w-[350px] flex-shrink-0">
				<div class="flex items-center mb-4">
					<div class="flex text-yellow-400 mr-2 text-lg">
						<span>â˜…â˜…â˜…â˜…â˜…</span>
					</div>
					<span class="text-sm text-gray-600">Hace 2 semanas</span>
				</div>
				<p class="text-gray-800 mb-4 leading-relaxed flex-grow">
					Estoy encantado de haber coincidido con este tipo de profesional, me trataron despuÃ©s de mi operaciÃ³n de prÃ³tesis de rodilla y he vuelto a ganar fuerza y movilidad incluso mÃ¡s que antes..ahora voy a ir a entrenar a grupos para mantenerme ğŸ’ªğŸ¼
				</p>
				<p class="font-semibold text-gray-900">Pedro Martinez Lopez</p>
			</div>
			</div>
		</div>
	</div>
</section>

<script>
	import { gsap } from 'gsap';

	function initReviews() {
		const reviewsTitle = document.querySelector('#reviews-title');
		const reviewsContainer = document.querySelector('.reviews-slider-container');
		const reviewsTrack = document.querySelector('.reviews-track');
		const reviewsTrackDuplicate = document.querySelector('.reviews-track-duplicate');
		
		if (!reviewsTitle || !reviewsContainer || !reviewsTrack || !reviewsTrackDuplicate) {
			requestAnimationFrame(initReviews);
			return;
		}

		// AnimaciÃ³n del tÃ­tulo
		gsap.set('#reviews-title', { opacity: 0, y: -30, scale: 0.9 });
		gsap.to('#reviews-title', {
			opacity: 1,
			y: 0,
			scale: 1,
			duration: 0.8,
			ease: 'back.out(1.7)'
		});

		// Combinar ambos tracks en uno solo para el slider
		const combinedTrack = document.createElement('div');
		combinedTrack.className = 'reviews-track-combined flex gap-6';
		combinedTrack.innerHTML = reviewsTrack.innerHTML + reviewsTrackDuplicate.innerHTML;
		
		// Limpiar el contenedor y agregar el track combinado
		reviewsContainer.innerHTML = '';
		reviewsContainer.appendChild(combinedTrack);

		const track = combinedTrack;
		const cards = track.querySelectorAll('.review-card');
		
		// Determinar nÃºmero de tarjetas visibles segÃºn el tamaÃ±o de pantalla
		const getVisibleCards = () => {
			if (window.innerWidth < 640) return 1; // mÃ³vil: 1 tarjeta
			if (window.innerWidth < 1024) return 2; // tablet: 2 tarjetas
			return 3; // desktop: 3 tarjetas
		};
		
		const gap = window.innerWidth < 640 ? 16 : 24; // gap-4 en mÃ³vil, gap-6 en desktop
		const containerWidth = reviewsContainer.offsetWidth || (window.innerWidth < 640 ? 320 : window.innerWidth < 1024 ? 768 : 1000);
		const visibleCards = getVisibleCards();
		let cardWidth = Math.floor((containerWidth - (gap * (visibleCards - 1))) / visibleCards);
		
		// Aplicar el ancho calculado a cada tarjeta
		cards.forEach(card => {
			card.style.width = cardWidth + 'px';
			card.style.minWidth = cardWidth + 'px';
		});
		
		let totalWidth = (cardWidth + gap) * cards.length;

		// Configurar el contenedor
		gsap.set(track, {
			x: 0,
			width: totalWidth + 'px'
		});

		// AnimaciÃ³n inicial de entrada
		gsap.set(cards, { opacity: 0, y: 30 });
		gsap.to(cards, {
			opacity: 1,
			y: 0,
			duration: 0.6,
			stagger: 0.1,
			ease: 'power2.out'
		});

		// FunciÃ³n para el slider infinito
		let animation: gsap.core.Tween | null = null;
		let isPaused = false;
		
		function startSlider() {
			// Recalcular totalWidth antes de iniciar
			totalWidth = (cardWidth + gap) * cards.length;
			
			// Calcular el ancho de la mitad para hacer el loop infinito
			const halfWidth = totalWidth / 2;
			
			// Si ya existe una animaciÃ³n, matarla primero
			if (animation) {
				animation.kill();
			}
			
			// Crear animaciÃ³n que se mueve continuamente (mÃ¡s lenta)
			animation = gsap.to(track, {
				x: -halfWidth,
				duration: 80, // 80 segundos para recorrer la mitad (mÃ¡s lento)
				ease: 'none',
				repeat: -1,
				modifiers: {
					x: (x) => {
						const val = parseFloat(x);
						if (val <= -halfWidth) {
							return '0';
						}
						return val + 'px';
					}
				}
			});
		}

		// Variables para drag/swipe
		let isDragging = false;
		let startX = 0;
		let currentX = 0;
		let scrollLeft = 0;
		let dragStartTime = 0;

		// FunciÃ³n para obtener la posiciÃ³n X actual del track
		function getTrackX() {
			return gsap.getProperty(track, 'x') as number;
		}

		// FunciÃ³n para establecer la posiciÃ³n X del track
		function setTrackX(x: number) {
			gsap.set(track, { x: x });
		}

		// FunciÃ³n para limitar el desplazamiento
		function constrainX(x: number) {
			const maxX = 0;
			const minX = -(totalWidth / 2);
			return Math.max(minX, Math.min(maxX, x));
		}

		// Mouse events para desktop
		const handleMouseDown = (e: MouseEvent) => {
			if (animation) {
				animation.pause();
				isPaused = true;
			}
			isDragging = true;
			reviewsContainer.style.cursor = 'grabbing';
			startX = e.pageX - reviewsContainer.offsetLeft;
			scrollLeft = getTrackX();
			dragStartTime = Date.now();
		};

		const handleMouseMove = (e: MouseEvent) => {
			if (!isDragging) return;
			e.preventDefault();
			const x = e.pageX - reviewsContainer.offsetLeft;
			const walk = (x - startX) * 1.5; // Multiplicador para mÃ¡s sensibilidad
			const newX = constrainX(scrollLeft + walk);
			setTrackX(newX);
		};

		const handleMouseUp = () => {
			if (!isDragging) return;
			isDragging = false;
			reviewsContainer.style.cursor = 'grab';
			
			// Si el drag fue muy corto y rÃ¡pido, no reiniciar animaciÃ³n
			const dragDuration = Date.now() - dragStartTime;
			if (dragDuration < 100) {
				// Reiniciar animaciÃ³n desde la posiciÃ³n actual
				const currentX = getTrackX();
				const halfWidth = totalWidth / 2;
				
				if (animation) {
					animation.kill();
				}
				
				// Calcular la posiciÃ³n relativa dentro del ciclo
				const relativeX = currentX % (-halfWidth);
				const newStartX = relativeX > 0 ? relativeX - halfWidth : relativeX;
				setTrackX(newStartX);
				
				animation = gsap.to(track, {
					x: -halfWidth,
					duration: 80,
					ease: 'none',
					repeat: -1,
					modifiers: {
						x: (x) => {
							const val = parseFloat(x);
							if (val <= -halfWidth) {
								return '0';
							}
							return val + 'px';
						}
					}
				});
				isPaused = false;
			} else {
				// Si fue un drag largo, reiniciar animaciÃ³n despuÃ©s de un momento
				setTimeout(() => {
					if (!isDragging && isPaused) {
						const currentX = getTrackX();
						const halfWidth = totalWidth / 2;
						
						if (animation) {
							animation.kill();
						}
						
						const relativeX = currentX % (-halfWidth);
						const newStartX = relativeX > 0 ? relativeX - halfWidth : relativeX;
						setTrackX(newStartX);
						
						animation = gsap.to(track, {
							x: -halfWidth,
							duration: 80,
							ease: 'none',
							repeat: -1,
							modifiers: {
								x: (x) => {
									const val = parseFloat(x);
									if (val <= -halfWidth) {
										return '0';
									}
									return val + 'px';
								}
							}
						});
						isPaused = false;
					}
				}, 500);
			}
		};

		const handleMouseLeave = () => {
			if (isDragging) {
				isDragging = false;
				reviewsContainer.style.cursor = 'grab';
				handleMouseUp();
			}
		};

		// Touch events para mÃ³vil
		const handleTouchStart = (e: TouchEvent) => {
			if (animation) {
				animation.pause();
				isPaused = true;
			}
			isDragging = true;
			startX = e.touches[0].pageX - reviewsContainer.offsetLeft;
			scrollLeft = getTrackX();
			dragStartTime = Date.now();
		};

		const handleTouchMove = (e: TouchEvent) => {
			if (!isDragging) return;
			const x = e.touches[0].pageX - reviewsContainer.offsetLeft;
			const walk = (x - startX) * 1.5;
			const newX = constrainX(scrollLeft + walk);
			setTrackX(newX);
		};

		const handleTouchEnd = () => {
			if (!isDragging) return;
			isDragging = false;
			
			const dragDuration = Date.now() - dragStartTime;
			if (dragDuration < 100) {
				const currentX = getTrackX();
				const halfWidth = totalWidth / 2;
				
				if (animation) {
					animation.kill();
				}
				
				const relativeX = currentX % (-halfWidth);
				const newStartX = relativeX > 0 ? relativeX - halfWidth : relativeX;
				setTrackX(newStartX);
				
				animation = gsap.to(track, {
					x: -halfWidth,
					duration: 80,
					ease: 'none',
					repeat: -1,
					modifiers: {
						x: (x) => {
							const val = parseFloat(x);
							if (val <= -halfWidth) {
								return '0';
							}
							return val + 'px';
						}
					}
				});
				isPaused = false;
			} else {
				setTimeout(() => {
					if (!isDragging && isPaused) {
						const currentX = getTrackX();
						const halfWidth = totalWidth / 2;
						
						if (animation) {
							animation.kill();
						}
						
						const relativeX = currentX % (-halfWidth);
						const newStartX = relativeX > 0 ? relativeX - halfWidth : relativeX;
						setTrackX(newStartX);
						
						animation = gsap.to(track, {
							x: -halfWidth,
							duration: 80,
							ease: 'none',
							repeat: -1,
							modifiers: {
								x: (x) => {
									const val = parseFloat(x);
									if (val <= -halfWidth) {
										return '0';
									}
									return val + 'px';
								}
							}
						});
						isPaused = false;
					}
				}, 500);
			}
		};

		// Event listeners para drag (mousemove y mouseup en document para que funcione fuera del contenedor)
		reviewsContainer.style.cursor = 'grab';
		reviewsContainer.addEventListener('mousedown', handleMouseDown);
		document.addEventListener('mousemove', handleMouseMove);
		document.addEventListener('mouseup', handleMouseUp);
		reviewsContainer.addEventListener('mouseleave', handleMouseLeave);

		// Touch events
		reviewsContainer.addEventListener('touchstart', handleTouchStart, { passive: true });
		reviewsContainer.addEventListener('touchmove', handleTouchMove, { passive: false });
		reviewsContainer.addEventListener('touchend', handleTouchEnd);

		// Pausar al hacer hover (solo si no estÃ¡ arrastrando)
		reviewsContainer.addEventListener('mouseenter', () => {
			if (!isDragging && animation && !isPaused) {
				animation.pause();
				isPaused = true;
			}
		});

		reviewsContainer.addEventListener('mouseleave', () => {
			if (!isDragging && animation && isPaused) {
				animation.resume();
				isPaused = false;
			}
		});
		
		// FunciÃ³n para recalcular y reiniciar el slider cuando cambia el tamaÃ±o
		function handleResize() {
			if (animation) {
				animation.kill();
			}
			
			const newGap = window.innerWidth < 640 ? 16 : 24;
			const newContainerWidth = reviewsContainer.offsetWidth || (window.innerWidth < 640 ? 320 : window.innerWidth < 1024 ? 768 : 1000);
			const newVisibleCards = getVisibleCards();
			cardWidth = Math.floor((newContainerWidth - (newGap * (newVisibleCards - 1))) / newVisibleCards);
			
			cards.forEach(card => {
				card.style.width = cardWidth + 'px';
				card.style.minWidth = cardWidth + 'px';
			});
			
			totalWidth = (cardWidth + newGap) * cards.length;
			
			gsap.set(track, {
				x: 0,
				width: totalWidth + 'px'
			});
			
			// Reiniciar el slider
			setTimeout(() => {
				startSlider();
			}, 100);
		}

		// Listener para cambios de tamaÃ±o de ventana
		let resizeTimeout;
		window.addEventListener('resize', () => {
			clearTimeout(resizeTimeout);
			resizeTimeout = setTimeout(handleResize, 250);
		}, { passive: true });

		// Iniciar el slider despuÃ©s de que las cartas aparezcan
		setTimeout(() => {
			startSlider();
		}, 1500);
	}

	// Inicializar cuando el DOM estÃ© listo
	if (typeof window !== 'undefined') {
		if (document.readyState === 'loading') {
			document.addEventListener('DOMContentLoaded', initReviews);
		} else {
			initReviews();
		}
	}
</script>

<style>
	.reviews-slider-container {
		position: relative;
		width: 100%;
		max-width: 1000px;
		margin: 0 auto;
		cursor: grab;
		user-select: none;
		-webkit-user-select: none;
		touch-action: pan-y;
		mask-image: linear-gradient(
			to right,
			transparent 0%,
			black 3%,
			black 97%,
			transparent 100%
		);
		-webkit-mask-image: linear-gradient(
			to right,
			transparent 0%,
			black 3%,
			black 97%,
			transparent 100%
		);
	}

	.reviews-slider-container:active {
		cursor: grabbing;
	}

	.reviews-track-combined {
		will-change: transform;
	}

	.review-card {
		transform-origin: center center;
		transform-style: preserve-3d;
		display: flex;
		flex-direction: column;
	}
	
	.review-card p:last-child {
		margin-top: auto;
		padding-top: 1rem;
	}
</style>

